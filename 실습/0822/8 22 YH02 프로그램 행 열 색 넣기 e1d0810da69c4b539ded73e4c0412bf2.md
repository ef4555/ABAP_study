# 8/22 YH02 프로그램 행/열 색 넣기

생성자: 최예훈
생성 일시: 2023년 8월 22일 오후 4:31
태그: ABAP

yh02 프로그램에서 수정 조회 모드 변경 시 라인과 열의 색이 바뀌도록 설정했었다.

row(행)은 결과값을 나타내는 it_list2 인터널 테이블에 linecolor 칼럼을 추가하고 조건에 따라 색을 넣었다. 내가 설정한 조건은 레벨 1과 1이 아닌것

column(열)은 수정 모드일 시 fieldcat을 바꾸어서 수정가능한 칼럼에 emphsize 속성에 ‘X’값을 주어서 제어했다.

인터널 테이블의 변화를 ALV 새로고침해서 보여주려면

refresh_table_display 구문을 사용하면 된다.

하지만 fieldcat의 변화는 refresh해도 반영되지 않는다. → 수정모드일때 색 변화하는 것은 alv_display로 set_table_for_first_display를 다시 해야한다

프로그램은 내가 생각한 대로 움직이긴 하였으나

문제점

1. 비효율적
2. 셀에 있는 커서 위치가 매번 초기화됨

열에 색을 주는 것은 필드카탈로그 제어가 아니라 cell 색 제어하는 방법을 이용해서 해야 하는 듯 하다.